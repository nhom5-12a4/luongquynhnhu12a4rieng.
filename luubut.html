<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>L∆∞u B√∫t 12A4</title>
  <style>
    *{box-sizing:border-box;font-family: "Segoe UI", sans-serif;}
    body{
      margin:0; min-height:100vh; color:#fff;
      background: linear-gradient(-45deg,#ff6ec4,#7873f5,#42e695,#f093fb);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
      overflow-x:hidden;
    }
    @keyframes gradientBG{
      0%{background-position:0% 50%;}
      50%{background-position:100% 50%;}
      100%{background-position:0% 50%;}
    }

    header{padding:50px 20px; text-align:center;}
    header h1{margin:0; font-size:38px; letter-spacing:1px;}
    header p{margin-top:10px; opacity:.9}

    .wrap{
      width:min(900px, 92vw);
      margin: 0 auto 40px;
      background: rgba(255,255,255,0.15);
      border-radius: 20px;
      padding: 22px;
      backdrop-filter: blur(15px);
      box-shadow: 0 8px 32px rgba(0,0,0,0.25);
    }

    .row{display:flex; gap:12px; flex-wrap:wrap;}
    input, textarea{
      width:100%;
      padding:12px 14px;
      border:none;
      border-radius: 12px;
      outline:none;
      font-size:16px;
    }
    .col-4{flex:1 1 220px;}
    .col-8{flex:2 1 380px;}

    button{
      margin-top: 10px;
      padding:10px 18px;
      border:none;
      border-radius: 16px;
      background:#ffd700;
      font-weight:800;
      cursor:pointer;
      transition:.2s;
    }
    button:hover{transform:scale(1.05); background:#ff9800;}

    .tools{display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-top:12px;}
    .ghost{
      background: rgba(0,0,0,0.25);
      color:#fff;
      font-weight:700;
    }
    .ghost:hover{background: rgba(0,0,0,0.35);}

    h2{margin: 18px 0 10px; text-align:center;}
    .list{display:flex; flex-direction:column; gap:12px; margin-top:10px;}
    .msg{
      background: rgba(0,0,0,0.25);
      border-radius: 16px;
      padding: 14px;
      line-height:1.4;
      position:relative;
    }
    .msg .meta{opacity:.9; font-size:14px; margin-bottom:6px;}
    .msg .name{font-weight:900;}
    .msg .time{opacity:.8;}
    .msg .text{white-space:pre-wrap;}

    .del{
      position:absolute; right:10px; top:10px;
      border:none; border-radius:12px;
      background: rgba(255,255,255,0.2);
      color:#fff; cursor:pointer;
      padding:6px 10px; font-weight:700;
    }
    .del:hover{background: rgba(255,255,255,0.3);}

    .back{
      display:block; width: fit-content; margin: 0 auto 40px;
      text-decoration:none; color:#111; font-weight:900;
      background: rgba(255,255,255,0.8);
      padding:10px 14px; border-radius: 14px;
    }

    /* Sao r∆°i */
    .star{
      position: fixed; top:-10px;
      width:3px; height:3px; background:white; border-radius:50%;
      opacity:.9; pointer-events:none;
      animation: fall linear infinite;
      z-index:0;
    }
    @keyframes fall{
      0%{ transform: translateY(-10vh); opacity:0; }
      10%{ opacity:1; }
      100%{ transform: translateY(110vh); opacity:0; }
    }
    header,.wrap,.back{position:relative; z-index:1;}
  </style>
</head>
<!-- Nh·∫°c n·ªÅn -->
<audio id="bgMusic" loop autoplay muted>
  <source src="ƒê·∫°i L·ªô M·∫∑t Tr·ªùi.mp3" type="audio/mp3">
</audio>

<!-- C·ª•m n√∫t nh·∫°c -->
<div class="music-bar">
  <button type="button" onclick="toggleMusic()">üéµ B·∫≠t/T·∫Øt Nh·∫°c</button>
  <button type="button" onclick="volDown()">üîâ -</button>
  <span id="volText">√Çm l∆∞·ª£ng: 30%</span>
  <button type="button" onclick="volUp()">üîä +</button>
</div>
<body>
  <header>
    <h1>üíå L∆∞u B√∫t 12A4</h1>
    <p>Vi·∫øt v√†i d√≤ng ƒë·ªÉ t·ª•i m√¨nh nh·ªõ nhau m√£i nha!</p>
  </header>

  <div class="wrap">
    <div class="row">
      <div class="col-4">
        <input id="name" type="text" placeholder="T√™n c·ªßa b·∫°n (vd: Minh, Lan...)" maxlength="30">
      </div>
      <div class="col-8">
        <textarea id="message" rows="3" placeholder="Vi·∫øt l·ªùi l∆∞u b√∫t..." maxlength="300"></textarea>
      </div>
    </div>

    <div class="tools">
      <button onclick="addMessage()">G·ª≠i l·ªùi nh·∫Øn</button>
      <button class="ghost" onclick="clearAll()">Xo√° h·∫øt (tr√™n m√°y b·∫°n)</button>
    </div>

    <h2>üìå L·ªùi nh·∫Øn ƒë√£ g·ª≠i</h2>
    <div id="messages" class="list"></div>
  </div>

  <a class="back" href="index.html">‚¨Ö V·ªÅ trang ch·ªß</a>

  <script>
    // ====== Sao r∆°i ======
    const STAR_COUNT = 70;
    for(let i=0;i<STAR_COUNT;i++){
      const s = document.createElement("div");
      s.className = "star";
      s.style.left = (Math.random()*100) + "vw";
      s.style.animationDelay = (-Math.random()*10) + "s";
      s.style.animationDuration = (3 + Math.random()*7) + "s";
      const size = 2 + Math.random()*3;
      s.style.width = size + "px";
      s.style.height = size + "px";
      document.body.appendChild(s);
    }

    // ====== L∆∞u b√∫t (LocalStorage) ======
    const KEY = "luubut_12a4_v1";

    function loadMessages(){
      try{
        return JSON.parse(localStorage.getItem(KEY)) || [];
      }catch(e){
        return [];
      }
    }

    function saveMessages(arr){
      localStorage.setItem(KEY, JSON.stringify(arr));
    }

    function formatTime(ts){
      const d = new Date(ts);
      return d.toLocaleString("vi-VN");
    }

    function render(){
      const box = document.getElementById("messages");
      const arr = loadMessages();
      box.innerHTML = "";

      if(arr.length === 0){
        box.innerHTML = `<div class="msg"><div class="text">Ch∆∞a c√≥ l·ªùi nh·∫Øn n√†o. B·∫°n l√† ng∆∞·ªùi ƒë·∫ßu ti√™n ƒë√≥ üòÑ</div></div>`;
        return;
      }

      arr.slice().reverse().forEach((m, idxFromEnd) => {
        const realIndex = arr.length - 1 - idxFromEnd;

        const div = document.createElement("div");
        div.className = "msg";
        div.innerHTML = `
          <button class="del" title="Xo√°" onclick="deleteMsg(${realIndex})">üóë</button>
          <div class="meta"><span class="name">${escapeHtml(m.name)}</span> ‚Ä¢ <span class="time">${formatTime(m.time)}</span></div>
          <div class="text">${escapeHtml(m.text)}</div>
        `;
        box.appendChild(div);
      });
    }

    function addMessage(){
      const nameEl = document.getElementById("name");
      const msgEl  = document.getElementById("message");

      const name = nameEl.value.trim();
      const text = msgEl.value.trim();

      if(!name || !text){
        alert("Nh·∫≠p ƒë·∫ßy ƒë·ªß T√™n + L·ªùi nh·∫Øn nha!");
        return;
      }

      const arr = loadMessages();
      arr.push({ name, text, time: Date.now() });
      saveMessages(arr);

      nameEl.value = "";
      msgEl.value = "";
      render();
    }

    function deleteMsg(i){
      const arr = loadMessages();
      arr.splice(i, 1);
      saveMessages(arr);
      render();
    }

    function clearAll(){
      if(confirm("Xo√° h·∫øt l·ªùi nh·∫Øn ƒëang l∆∞u tr√™n m√°y b·∫°n?")){
        localStorage.removeItem(KEY);
        render();
      }
    }

    function escapeHtml(str){
      return str
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    render();
  // ====== Nh·∫°c n·ªÅn ======
const music = document.getElementById("bgMusic");
let vol = 0.3;         // m·∫∑c ƒë·ªãnh 30%
music.volume = vol;

function updateVolText(){
  document.getElementById("volText").textContent = "√Çm l∆∞·ª£ng: " + Math.round(vol*100) + "%";
}
updateVolText();

function volUp(){
  vol = Math.min(1, vol + 0.1);
  music.volume = vol;
  updateVolText();
}
function volDown(){
  vol = Math.max(0, vol - 0.1);
  music.volume = vol;
  updateVolText();
}

function toggleMusic(){
  if(music.paused){
    music.muted = false;
    music.play().catch(()=>{});
  }else{
    music.pause();
  }
}

// c·ªë g·∫Øng autoplay khi load
window.addEventListener("load", () => {
  music.play().catch(()=>{});
});

// click l·∫ßn ƒë·∫ßu -> b·∫≠t ti·∫øng + play (v∆∞·ª£t ch·∫∑n autoplay)
document.addEventListener("click", () => {
  music.muted = false;
  music.play().catch(()=>{});
}, { once: true });
  </script>
</html>